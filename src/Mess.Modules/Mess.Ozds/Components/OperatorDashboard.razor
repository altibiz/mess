@using Mess.Ozds.Abstractions.Indexes
@using Mess.Iot.Abstractions.Models
@using Mess.Ozds.Abstractions.Models
@using OrchardCore.Users.Models
@using OrchardCore.ContentFields.Indexing.SQL
@inject ISession _session

if (_distributionSystemOperator is not null) {
}

@code {
  [Parameter]
  public User AuthenticatedUser { get; set; } = default!;

  private DistributionSystemOperatorItem? _distributionSystemOperator;

  protected override async Task OnInitializedAsync()
  {
    _distributionSystemOperator = (await _session
      .Query<ContentItem, UserPickerFieldIndex>()
      .Where(index => index.ContentPart == "LegalEntityPart")
      .Where(index => index.SelectedUserId == AuthenticatedUser.UserId)
      .FirstOrDefaultAsync())
      .AsContent<DistributionSystemOperatorItem>();
  }
}

